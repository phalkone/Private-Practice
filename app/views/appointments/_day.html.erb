<ul>
  <% @appointments.each() do |app| %>
      <li><%= l(app.begin, :format => :time) %>-<%= l(app.end, :format => :time) %> <%= app.patient.name %> (<%= app.id %>) <%= link_to "Delete", app, :remote => true, 
        :confirm => t("appointments.confirmation"), :method => :delete %></li>
  <% end %>
</ul>

<table class="day">
  <thead>
    <tr>
      <th colspan="<%= @maxcols + 1 %>"><%= l(@date, :format => :long) %></th>
    <tr>
  </thead>
  <tbody>
    <% for i in 0..(((@stop-@start)*4)-1) %>
    <tr>
      <% if ((i % 4) == 0) %>
        <% hour = i/4 + @start %>
        <td rowspan="4" class="hour"><span class="big"><%= hour %></span><span class="superscript">00</span></td>
      <% end %>

      <% if @dayarray[i][0] == -1 %>
        <td colspan="<%= @maxcols %>"></td>
      <% elsif @dayarray[i][0] != -2 %>
        <% colspan = (@maxcols/@dayarray[i][0]) %>
        <% for j in 1..(@dayarray[i].length - 1) %>
          <% app = @appointments.find_by_id(@dayarray[i][j]) %>
          <td rowspan="<%= app.rowspan %>" colspan="<%= colspan %>"><span class="bar" style="padding-bottom:<%= app.bottom*2 %>px; padding-top:<%= ((app.top*2)-((@dayarray[i][0])*2))+1 %>px;"><span class="bar2"></span></span><%= l(app.begin, :format => :time) %>-<%= l(app.end, :format => :time) %> <%= app.patient.name %></td>
        <% end %>
      <% end %>
    </tr>
    <% end %>
  </tbody>
</table>
