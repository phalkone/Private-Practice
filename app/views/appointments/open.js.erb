$("#dialog").html("<%= escape_javascript(render(:partial => "form")) %>");
$("#registered").buttonset().change(function() {
  if($("#view_registered_reg").attr("checked")){
    $("#patient").html("<%= escape_javascript(render(:partial => "users_list")) %>");
  } else {
    $("#patient").html("<%= escape_javascript(render(:partial => "user_form")) %>");
  }
});
$("#appointment_date").datepicker($.datepicker.regional[ "<%= I18n.locale %>" ]);
$("#appointment_date").datepicker( "option", "dateFormat", 'dd/mm/yy' );
var values = $( "#slider-range" ).slider( "option", "values" );
<% if @appointment.begin.nil? %>
$("#appointment_date").datepicker( "setDate" , $("#datepicker").datepicker("getDate"));
var begin_slider = values[0]*60;
var end_slider = values[1]*60;
<% else %>
var begin_slider = <%= escape_javascript(@begin_slider.to_s) %>;
var end_slider = <%= escape_javascript(@end_slider.to_s) %>;
<% end %>

$("#hour-slider").slider({
      range: true, step: 5, min: values[0]*60, max: values[1]*60, 
      values: [begin_slider, end_slider],
      slide: function(event, ui) {
        var beginmin = ui.values[0] % 60;
        var beginhour = (ui.values[0] - (beginmin))/60;
        var endmin = ui.values[1] % 60;
        var endhour = (ui.values[1] - (endmin))/60;
        $("#appointment_begin_time").val(zero(beginhour) + ":" + zero(beginmin));
        $("#appointment_end_time").val(zero(endhour) + ":" + zero(endmin));
   }
});
$("#dialog").dialog({
    modal: true, height: 520, width: 350, position: [($(window).width()-300)/2,20],
    title: "<%= escape_javascript(@title) %>",
    buttons: {
       Ok: function() {
        $("#dialog form").submit();
      },
       Cancel: function() {
        $( this ).dialog( "destroy" );
      }
    }
});
function zero(n){
  if (n < 10 ) {
    var ret = "0" + n;
  } else {
    var ret = n;
  }
  return ret;
}
